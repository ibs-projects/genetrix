@model genetrix.Models.Banque

@{
    ViewBag.Title = "Banque";
    ViewBag.pTitle = "Detail Banque";
    ViewBag.pageTitle = "Banque";
    ViewBag.pageImage = "~/assets/images/IU/bank.png";
}

@Html.Partial("~/Views/_Shared/_head_css.cshtml")
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header card-header1 text-white">
                Synchronisation des données utilisateurs
            </div>
            <div class="card-body">
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()

                    <div class="form-horizontal">
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        @Html.HiddenFor(model => model.Id)

                        <div class="row">
                            <div class="form-group mb-3 row">
                                <div class="col-md-10">
                                    <div class="checkbox">
                                        @*@Html.EditorFor(model => model.Activetimer, new { id = "StopAtimer" })*@
                                        <input id="StopAtimer" type="checkbox" name="Activetimer" checked="@(Model.Activetimer?"checked":"")" value="" />
                                        @Html.LabelFor(model => model.Activetimer, htmlAttributes: new { @class = "control-label" })
                                        @Html.ValidationMessageFor(model => model.Activetimer, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="col-md-4 hidden">
                                    @Html.LabelFor(model => model.Interval, htmlAttributes: new { @class = "control-label" })
                                    @Html.EditorFor(model => model.Interval, new { htmlAttributes = new { @class = "form-control", id = "HeureExecuteDebut" } })
                                    @Html.ValidationMessageFor(model => model.Interval, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group mb-3 col-6">
                                @Html.LabelFor(model => model.HeureExecuteDebut, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-10">
                                    @Html.EditorFor(model => model.HeureExecuteDebut, new { htmlAttributes = new { @class = "form-control",id= "HeureExecuteDebut" } })
                                    @Html.ValidationMessageFor(model => model.HeureExecuteDebut, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="form-group mb-3 col-6">
                                @Html.LabelFor(model => model.HeureExecuteFin, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-10">
                                    @Html.EditorFor(model => model.HeureExecuteFin, new { htmlAttributes = new { @class = "form-control",id= "HeureExecuteFin" } })
                                    @Html.ValidationMessageFor(model => model.HeureExecuteFin, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <div class="col-md-offset-2 col-md-10">
                                <input type="submit" value="Enregister" class="btn btn-primary" />
                            </div>
                        </div>
                    </div>
                }
                <hr />
                <div class="row">
                    <div class="col-6">
                        <a class="btn" style="cursor:alias"><span>Debut lecture: </span><span id="time"></span></a>
                    </div>
                    <div class="col-6">
                        <a href="#" id="execute-async" class="btn btn-info"><i class="mdi mdi-sync"></i> Executer</a>
                    </div>                
                </div>
            </div>
            <div class="card-footer">
                <p>
                    @Html.ActionLink("Accueil", "Details", new { id = Model.Id })
                </p>
            </div>
        </div>
        <hr />
        <div class="card">
            <div class="card-header card-header1 text-white">
                Délais de traitement des données
            </div>
            <div class="card-body">
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()

                    <div class="form-horizontal">
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        @Html.HiddenFor(model => model.Id)

                        <div class="row">
                            <div class="form-group mb-3 col-6">
                                @Html.LabelFor(model => model.TempsPassageArchivage, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-12">
                                    @Html.EditorFor(model => model.TempsPassageArchivage, new { htmlAttributes = new { @class = "form-control",id= "HeureExecuteDebut" } })
                                    @Html.ValidationMessageFor(model => model.TempsPassageArchivage, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="form-group mb-3 col-6">
                                @Html.LabelFor(model => model.DureeArchivage, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-12">
                                    @Html.EditorFor(model => model.DureeArchivage, new { htmlAttributes = new { @class = "form-control",id= "HeureExecuteFin" } })
                                    @Html.ValidationMessageFor(model => model.DureeArchivage, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <div class="col-md-offset-2 col-md-10">
                                <input type="submit" value="Enregister" class="btn btn-primary" />
                            </div>
                        </div>
                    </div>
                }
                <hr />
                <div class="row">
                    <div class="col-6">
                        <a class="btn" style="cursor:alias"><span>Debut lecture: </span><span id="time"></span></a>
                    </div>
                    <div class="col-6">
                        <a href="#" id="execute-async" class="btn btn-info"><i class="mdi mdi-sync"></i> Executer</a>
                    </div>                
                </div>
            </div>
            <div class="card-footer">
                <p>
                    @Html.ActionLink("Accueil", "Details", new { id = Model.Id })
                </p>
            </div>
        </div>
        
        <hr />
        <div class="card">
            <div class="card-header card-header1 text-white">
                Synchronisation des mails
            </div>
            <div class="card-body">
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()

                    <div class="form-horizontal">
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        @Html.HiddenFor(model => model.Id)
                        <div class="row">
                            <div class="form-group mb-3 col-6">
                                @Html.LabelFor(model => model.DureeRappelMiseEnDemaure, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-12">
                                    @Html.EditorFor(model => model.DureeRappelMiseEnDemaure, new { htmlAttributes = new { @class = "form-control",id= "HeureExecuteDebut" } })
                                    @Html.ValidationMessageFor(model => model.DureeRappelMiseEnDemaure, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="form-group mb-3 col-6">
                                @Html.LabelFor(model => model.JourRecptionRecapGes, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-12">
                                    @Html.EnumDropDownListFor(model => model.JourRecptionRecapGes, htmlAttributes: new { @class = "form-control" })
                                    @Html.ValidationMessageFor(model => model.JourRecptionRecapGes, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="form-group mb-3 col-6 hidden">
                                @Html.LabelFor(model => model.RelanceDossierEchu, htmlAttributes: new { @class = "control-label" })
                                <div class="col-md-12">
                                    @Html.EditorFor(model => model.RelanceDossierEchu, new { htmlAttributes = new { @class = "form-control", id = "HeureExecuteDebut" } })
                                    @Html.ValidationMessageFor(model => model.RelanceDossierEchu, "", new { @class = "text-danger" })
                                </div>
                            </div>

                        </div>
                        <div class="form-group mb-3">
                            <div class="col-md-offset-2 col-md-10">
                                <input type="submit" value="Enregister" class="btn btn-primary" />
                            </div>
                        </div>
                    </div>
                }
                <hr />
                <div class="row">
                    <div class="col-6">
                        <a class="btn" style="cursor:alias"><span>Debut lecture: </span><span id="time"></span></a>
                    </div>
                    <div class="col-6">
                        <a href="#" id="execute-async" class="btn btn-info"><i class="mdi mdi-sync"></i> Executer</a>
                    </div>                
                </div>
            </div>
            <div class="card-footer">
                <p>
                    @Html.ActionLink("Accueil", "Details", new { id = Model.Id })
                </p>
            </div>
        </div>
    </div>
</div>


@Html.Partial("~/Views/_Shared/_Script_DataList.cshtml")

<script>
  $('#execute-async').click(function () {
            $.ajax({
                url: '@Url.Content("~/index/MiseDemeureAction?stop=")' + document.getElementById('StopAtimer').checked + "&interval=" + $('#Interval').val() + "&heureExecuteDebut=" + $('#HeureExecuteDebut').val() + "&heureExecuteFin=" + $('#HeureExecuteFin').val(),
                success: function (responce) {
                    alert('Lecture données d\'arrière plan activée');
                },
                error: function (responce) { alert("Echec du lancement données d'arriere plan") }
            });
        });

        (function GetTime() {
            $.ajax({
                url: '@Url.Content("~/index/GetTimeSinceAsync")',
                success: function (responce) {
                    $('#time').text(responce);
                },
                error: function (responce) {  }
            });
        })();
</script>