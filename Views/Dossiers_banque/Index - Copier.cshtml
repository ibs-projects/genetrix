@using genetrix.Models;
@model IEnumerable<genetrix.Models.Dossier>

@{
    int numComp = 0, menu = 0; double montantcv = 0;
    string filtre = ViewBag.par + "";
    try
    {
        numComp = Convert.ToInt32(Session["NumComposant"]);
    }
    catch (Exception)
    { }
    try
    {
        menu = Convert.ToInt32(Session["menu"].ToString());
    }
    catch (Exception)
    { }
    try
    {
        montantcv = Convert.ToDouble(ViewData["montantcv"].ToString());
    }
    catch (Exception)
    { }
    int minSite = 0, maxSite = 0;
    try
    {
        minSite = Convert.ToInt32(Session["userSIteMinNiveau"]);
        maxSite = Convert.ToInt32(Session["userSIteMaxNiveau"]);
    }
    catch (Exception)
    { }
    ViewBag.minSite = minSite;
    ViewBag.maxSite = maxSite;
    ApplicationDbContext db = new ApplicationDbContext();
    ViewBag.Title = "Dossiers";
    ViewBag.pTitle = ViewBag.statut;
    ViewBag.pageTitle = "Dossiers";
    ViewBag.pageImage = "~/assets/images/IU/encours.png";
    //Layout = "~/Views/_Shared/_Layout.cshtml";
}

<!-- DataTables -->
<link href="~/assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />

<!-- Responsive datatable examples -->
<link href="~/assets/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" />
@Html.Partial("~/Views/_Shared/_head_css.cshtml")

<style>
    .card-header {
        display: none;
    }

    .bg-1 {
        background-color: #568687;
    }

    .att {
        cursor: initial;
        text-align: center;
    }

    .icon-action {
        cursor: pointer;
    }

        .icon-action:hover {
            padding: 20px;
            background-color: rgb(173, 231, 239, 0.24);
        }
</style>

@{
    @*if (Session["Profile"]=="banque")
        {
            <p>
                <a class="" href="@Url.Action("Create","Dossiers")" id="scanner-1">
                    <i class="dripicons-plus me-2"></i>
                    Nouveau dossier
                </a>
            </p>
        }*@
}
@{ var action = false;}

@{
    //service transfert fixé
    if (minSite == 9)//minSite=service transfert
    {
        if (filtre == "9_9_9")
        {
            <div class="row">
                <div class="card1">
                    <div class="card-body1">
                        <ul class="nav nav-pills nav-justified bg-default" role="tablist" style="margin-left:15px;margin-right:15px;margin-bottom:-12px">
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link active" data-bs-toggle="tab" href="#navpills2-home"
                                   role="tab">
                                    <i class="mdi mdi-currency-eur"></i>&emsp; @Model.Where(d => d.MontantCV <= montantcv).Count() EURO
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#navpills2-profile" role="tab">
                                    <i class="mdi mdi-currency-eth"></i>&emsp; @Model.Where(d => d.MontantCV > montantcv).Count() Autres devises
                                </a>
                            </li>
                        </ul>

                        <div class="tab-content p-3 text-muted">
                            <div class="tab-pane active" id="navpills2-home" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Actions
                                                        </th>
                                                        <th>
                                                            @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ int i = 0;}
                                                    @foreach (var item in Model.Where(d => d.MontantCV <= montantcv))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.ReferenceExterne != null)
                                                                    {
                                                                        try
                                                                        {
                                                                            <label>@item.ReferenceExterne.NumeroRef</label>
                                                                        }
                                                                        catch (Exception)
                                                                        { }
                                                                    }
                                                                    else
                                                                    {
                                                                        <label>Non attribuée</label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @*@Html.DisplayFor(modelItem => item.EtapesDosier) |
                                                                    @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)*@
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="navpills2-profile" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Actions
                                                        </th>
                                                        <th>
                                                            @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ i = 0;}
                                                    @foreach (var item in Model.Where(d => d.MontantCV > montantcv))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.ReferenceExterne != null)
                                                                    {
                                                                        try
                                                                        {
                                                                            <label>@item.ReferenceExterne.NumeroRef</label>
                                                                        }
                                                                        catch (Exception)
                                                                        { }
                                                                    }
                                                                    else
                                                                    {
                                                                        <label>Non attribuée</label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }


                                        }
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        }
        else if (filtre.Contains("10_10"))
        {
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">

                            <div class="table-responsive">
                                <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                    <thead>
                                        <tr>
                                            <th>
                                                Actions
                                            </th>
                                            <th>
                                                @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                            </th>
                                            <th>
                                                @Html.DisplayName("Client")
                                            </th>

                                            <th>
                                                @Html.DisplayNameFor(model => model.Fournisseur)
                                            </th>

                                            <th>
                                                @Html.DisplayNameFor(model => model.Montant)
                                            </th>
                                            <th>
                                                @Html.DisplayName("Devise")
                                            </th>

                                            <th>
                                                @Html.DisplayName("Statut")
                                            </th>
                                            <th class="partage">Responsable</th>
                                            <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                        </tr>

                                    </thead>


                                    <tbody>
                                        @{ int i = 0;}
                                        @foreach (var item in Model)
                                        {
                                            i++;
                                            <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                <td class="att">
                                                    <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                </td>
                                                <td>
                                                    @{
                                                        if (item.ReferenceExterne != null)
                                                        {
                                                            try
                                                            {
                                                                <label>@item.ReferenceExterne.NumeroRef</label>
                                                            }
                                                            catch (Exception)
                                                            { }
                                                        }
                                                        else
                                                        {
                                                            <label>Non attribuée</label>
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Client.Nom)
                                                </td>
                                                <td>
                                                    @{
                                                        if (item.Fournisseur != null)
                                                        {
                                                            <label>
                                                                @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                            </label>
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.MontantString)
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                </td>

                                                <td>
                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                </td>
                                                <td class="att">
                                                    @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                </td>
                                                @{
                                                    if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                    {
                                                        action = true;
                                                        <td style="font-size:large;padding:0px!important;text-align:center">
                                                            <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                <i class="mdi mdi-delete"></i>
                                                            </a>
                                                        </td>
                                                    }
                                                }
                                            </tr>
                                        }

                                    </tbody>
                                </table>
                            </div>
                            @{
                                if (action)
                                {
                                    <style>
                                        #tb-action {
                                            display: initial;
                                        }
                                    </style>

                                }
                            }
                        </div>
                    </div>
                </div> <!-- end col -->
            </div>
        }
        else if (filtre == "10_18_20")
        {
            <div class="row">
                <div class="card1">
                    <div class="card-body1">
                        <ul class="nav nav-pills nav-justified bg-default" role="tablist" style="margin-left:15px;margin-right:15px;margin-bottom:-12px">
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link active" data-bs-toggle="tab" href="#navpills2-home"
                                   role="tab">
                                    <i class="mdi mdi-book-multiple-outline"></i>&emsp; @Model.Where(d => d.EtapesDosier == 18).Count() Couverture devise en cours
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#navpills2-profile" role="tab">
                                    <i class="mdi mdi-book-multiple-outline"></i>&emsp; @Model.Where(d => d.EtapesDosier == 20).Count() Devise reçu
                                </a>
                            </li>
                        </ul>

                        <div class="tab-content p-3 text-muted">
                            <div class="tab-pane active" id="navpills2-home" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Actions
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        @*<th>
                                                                @Html.DisplayName("Agence")
                                                            </th>*@
                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ int i = 0;}
                                                    @foreach (var item in Model.Where(d => d.EtapesDosier == 18))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }
                                        }
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane" id="navpills2-profile" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ i = 0;}
                                                    @foreach (var item in Model.Where(d => d.EtapesDosier == 20))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }


                                        }
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        }
        else if (filtre == "10_11_14")
        {
            int nb11 = 0, nb12 = 0, nb13 = 0;
            try
            {
                var vg = ViewBag.globalvariable as VariablGlobales;
                nb11 = Model.Where(d => d.EtapesDosier == 11).Count();
                nb12 = Model.Where(d => d.EtapesDosier == 12).Count();
                nb13 = Model.Where(d => d.EtapesDosier == 13).Count();
            }
            catch (Exception)
            { }
            <div class="row">
                <div class="card1">
                    <div class="card-body1">
                        <ul class="nav nav-pills nav-justified bg-default" role="tablist" style="margin-left:15px;margin-right:15px;margin-bottom:-12px">
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link active" data-bs-toggle="tab" href="#verification"
                                   role="tab">
                                    @(nb11>99?"99+":""+nb11) <i class="mdi mdi-book-multiple-outline"></i>&emsp; Vérification en cours
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#referencement" role="tab">
                                    @(nb12>99?"99+":""+nb12) <i class="mdi mdi-book-multiple-outline"></i>&emsp; Référencement en cours
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#reference" role="tab">
                                    @(nb13>99?"99+":""+nb13) <i class="mdi mdi-book-multiple-outline"></i>&emsp; Dossiers référencés
                                </a>
                            </li>
                        </ul>

                        <div class="tab-content p-3 text-muted">
                            <div class="tab-pane active" id="verification" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons0" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>Actions</th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Agence")
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ int i = 0;}
                                                    @foreach (var item in Model.Where(d => d.EtapesDosier == 11))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.EtapesDosier) |
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }
                                        }
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane" id="referencement" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons1" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>Actions</th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ i = 0;}
                                                    @foreach (var item in Model.Where(d => d.EtapesDosier == 12))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }


                                        }
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane" id="reference" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons2" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>Actions</th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>

                                                </thead>


                                                <tbody>
                                                    @{ i = 0;}
                                                    @foreach (var item in Model.Where(d => d.EtapesDosier == 13))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }


                                        }
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        }
        else if (filtre == "22_22_22")
        {
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">

                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Actions</th>
                                        <th>
                                            @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                        </th>
                                        <th>
                                            @Html.DisplayName("Client")
                                        </th>

                                        <th>
                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                        </th>

                                        <th>
                                            @Html.DisplayNameFor(model => model.Montant)
                                        </th>
                                        <th>
                                            @Html.DisplayName("Devise")
                                        </th>

                                        <th>
                                            @Html.DisplayName("Statut")
                                        </th>
                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                    </tr>

                                </thead>


                                <tbody>
                                    @{ int i = 0;}
                                    @foreach (var item in Model.Where(d => d.EtapesDosier == 22))
                                    {
                                        i++;
                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                            <td class="att">
                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                            </td>
                                            <td>
                                                @{
                                                    if (item.ReferenceExterne != null)
                                                    {
                                                        try
                                                        {
                                                            <label>@item.ReferenceExterne.NumeroRef</label>
                                                        }
                                                        catch (Exception)
                                                        { }
                                                    }
                                                    else
                                                    {
                                                        <label>Non attribuée</label>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                            </td>
                                            <td>
                                                @{
                                                    if (item.Fournisseur != null)
                                                    {
                                                        <label>
                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                        </label>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.MontantString)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                            </td>

                                            <td>
                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                            </td>

                                            @{
                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                {
                                                    action = true;
                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                            <i class="mdi mdi-delete"></i>
                                                        </a>
                                                    </td>
                                                }
                                            }
                                        </tr>
                                    }

                                </tbody>
                            </table>

                            @{
                                if (action)
                                {
                                    <style>
                                        #tb-action {
                                            display: initial;
                                        }
                                    </style>

                                }
                            }
                        </div>
                    </div>
                </div> <!-- end col -->
            </div>
        }
        else if (filtre == "21_15_18")
        {
            <div class="row">
                <div class="card1">
                    <div class="card-body1">
                        @{
                            if (false)
                            {
                                <ul class="nav nav-pills nav-justified bg-default" role="tablist" style="margin-left:15px;margin-right:15px;margin-bottom:-12px">
                                    <li class="nav-item waves-effect waves-light">
                                        <a class="nav-link active" data-bs-toggle="tab" href="#encours-1" role="tab">
                                            <i class="mdi mdi-tag-multiple"></i>&emsp; En cours
                                        </a>
                                    </li>
                                    <li class="nav-item waves-effect waves-light">
                                        <a class="nav-link" data-bs-toggle="tab" href="#traités" role="tab">
                                            <i class="mdi mdi-tag-multiple"></i>&emsp; Accordés
                                        </a>
                                    </li>
                                    <li class="nav-item waves-effect waves-light">
                                        <a class="nav-link" data-bs-toggle="tab" href="#rejetes" role="tab">
                                            <i class="mdi mdi-tag-multiple"></i>&emsp; Rejetés
                                        </a>
                                    </li>
                                </ul>
                            }
                        }
                        <div class="tab-content p-3 text-muted">
                            <div class="tab-pane active" id="encours-1" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <div class="table-responsive">
                                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>Actions</th>
                                                        <th>
                                                            @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Client")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                                        </th>

                                                        <th>
                                                            @Html.DisplayNameFor(model => model.Montant)
                                                        </th>
                                                        <th>
                                                            @Html.DisplayName("Devise")
                                                        </th>

                                                        <th>
                                                            @Html.DisplayName("Statut")
                                                        </th>
                                                        <th class="partage">Responsable</th>
                                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{ int i = 0;}
                                                    @foreach (var item in Model)//.Where(d => d.EtapesDosier < 5))
                                                    {
                                                        i++;
                                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                            <td class="att">
                                                                <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.ReferenceExterne != null)
                                                                    {
                                                                        try
                                                                        {
                                                                            <label>@item.ReferenceExterne.NumeroRef</label>
                                                                        }
                                                                        catch (Exception)
                                                                        { }
                                                                    }
                                                                    else
                                                                    {
                                                                        <label>Non attribuée</label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                                            </td>
                                                            <td>
                                                                @{
                                                                    if (item.Fournisseur != null)
                                                                    {
                                                                        <label>
                                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                        </label>
                                                                    }
                                                                }
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.MontantString)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                            </td>

                                                            <td>
                                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                            </td>
                                                            <td class="att">
                                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                            </td>
                                                            @{
                                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                {
                                                                    action = true;
                                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                            <i class="mdi mdi-delete"></i>
                                                                        </a>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @{
                                if (false)
                                {
                                    <div class="tab-pane" id="traités" role="tabpanel" style="">
                                        <div class="card">
                                            <div class="card-body">

                                                <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                    <thead>
                                                        <tr>
                                                            <th>
                                                                @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                            </th>
                                                            <th>
                                                                @Html.DisplayName("Client")
                                                            </th>

                                                            <th>
                                                                @Html.DisplayNameFor(model => model.Fournisseur)
                                                            </th>

                                                            <th>
                                                                @Html.DisplayNameFor(model => model.Montant)
                                                            </th>
                                                            <th>
                                                                @Html.DisplayName("Devise")
                                                            </th>

                                                            <th>
                                                                @Html.DisplayName("Statut")
                                                            </th>
                                                            <th class="partage">Responsable</th>
                                                            <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                        </tr>

                                                    </thead>


                                                    <tbody>
                                                        @{ i = 0;}
                                                        @foreach (var item in Model.Where(d => d.EtapesDosier == 10))//.Where(d => d.EtapesDosier < 5))
                                                        {
                                                            i++;
                                                            <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                                <td>
                                                                    @{
                                                                        if (item.ReferenceExterne != null)
                                                                        {
                                                                            try
                                                                            {
                                                                                <label>@item.ReferenceExterne.NumeroRef</label>
                                                                            }
                                                                            catch (Exception)
                                                                            { }
                                                                        }
                                                                        else
                                                                        {
                                                                            <label>Non attribuée</label>
                                                                        }
                                                                    }
                                                                </td>
                                                                <td>
                                                                    @Html.DisplayFor(modelItem => item.Client.Nom)
                                                                </td>
                                                                <td>
                                                                    @{
                                                                        if (item.Fournisseur != null)
                                                                        {
                                                                            <label>
                                                                                @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                            </label>
                                                                        }
                                                                    }
                                                                </td>
                                                                <td>
                                                                    @Html.DisplayFor(modelItem => item.Montant)
                                                                </td>
                                                                <td>
                                                                    @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                                </td>

                                                                <td>
                                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                                </td>
                                                                <td class="att">
                                                                    @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                                </td>
                                                                @{
                                                                    if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                    {
                                                                        action = true;
                                                                        <td style="font-size:large;padding:0px!important;text-align:center">
                                                                            <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                                <i class="mdi mdi-delete"></i>
                                                                            </a>
                                                                        </td>
                                                                    }
                                                                }
                                                            </tr>
                                                        }

                                                    </tbody>
                                                </table>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane" id="rejetes" role="tabpanel">
                                        <div class="card">
                                            <div class="card-body">

                                                <table id="datatable-buttons1" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                                    <thead>
                                                        <tr>
                                                            <th>
                                                                @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                            </th>
                                                            <th>
                                                                @Html.DisplayName("Client")
                                                            </th>

                                                            <th>
                                                                @Html.DisplayNameFor(model => model.Fournisseur)
                                                            </th>

                                                            <th>
                                                                @Html.DisplayNameFor(model => model.Montant)
                                                            </th>
                                                            <th>
                                                                @Html.DisplayName("Devise")
                                                            </th>

                                                            <th>
                                                                @Html.DisplayName("Statut")
                                                            </th>
                                                            <th class="partage">Responsable</th>
                                                            <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                        </tr>

                                                    </thead>


                                                    <tbody>
                                                        @{ i = 0;}
                                                        @foreach (var item in Model.Where(d => d.EtapesDosier == -4))//.Where(d => d.EtapesDosier < 5))
                                                        {
                                                            i++;
                                                            <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                                <td>
                                                                    @{
                                                                        if (item.ReferenceExterne != null)
                                                                        {
                                                                            try
                                                                            {
                                                                                <label>@item.ReferenceExterne.NumeroRef</label>
                                                                            }
                                                                            catch (Exception)
                                                                            { }
                                                                        }
                                                                        else
                                                                        {
                                                                            <label>Non attribuée</label>
                                                                        }
                                                                    }
                                                                </td>
                                                                <td>
                                                                    @Html.DisplayFor(modelItem => item.Client.Nom)
                                                                </td>
                                                                <td>
                                                                    @{
                                                                        if (item.Fournisseur != null)
                                                                        {
                                                                            <label>
                                                                                @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                            </label>
                                                                        }
                                                                    }
                                                                </td>
                                                                <td>
                                                                    @Html.DisplayFor(modelItem => item.MontantString)
                                                                </td>
                                                                <td>
                                                                    @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                                </td>

                                                                <td>
                                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                                </td>
                                                                <td class="att">
                                                                    @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                                </td>
                                                                @{
                                                                    if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                                    {
                                                                        action = true;
                                                                        <td style="font-size:large;padding:0px!important;text-align:center">
                                                                            <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                                <i class="mdi mdi-delete"></i>
                                                                            </a>
                                                                        </td>
                                                                    }
                                                                }
                                                            </tr>
                                                        }

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        </div>
                    </div>
                </div>

            </div>

        }
        else if (filtre == "422_19_21")
        {
            <div class="card">
                <div class="card-body">

                    <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                        <thead>
                            <tr>
                                <th>Actions</th>
                                <th>
                                    @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                </th>
                                <th>
                                    @Html.DisplayName("Client")
                                </th>

                                <th>
                                    @Html.DisplayNameFor(model => model.Fournisseur)
                                </th>

                                <th>
                                    @Html.DisplayNameFor(model => model.Montant)
                                </th>
                                <th>
                                    @Html.DisplayName("Devise")
                                </th>

                                <th>
                                    @Html.DisplayName("Statut")
                                </th>
                                <th class="partage">Responsable</th>
                                <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{ int i = 100;}
                            @foreach (var item in Model.Where(d => d.EtapesDosier == 10))//.Where(d => d.EtapesDosier < 5))
                            {
                                i++;
                                <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                    <td class="att">
                                        <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                    </td>
                                    <td>
                                        @{
                                            if (item.ReferenceExterne != null)
                                            {
                                                try
                                                {
                                                    <label>@item.ReferenceExterne.NumeroRef</label>
                                                }
                                                catch (Exception)
                                                { }
                                            }
                                            else
                                            {
                                                <label>Non attribuée</label>
                                            }
                                        }
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Client.Nom)
                                    </td>
                                    <td>
                                        @{
                                            if (item.Fournisseur != null)
                                            {
                                                <label>
                                                    @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                </label>
                                            }
                                        }
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.MontantString)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                    </td>

                                    <td>
                                        @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                    </td>
                                    <td class="att">
                                        @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                    </td>
                                    @{
                                        if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                        {
                                            action = true;
                                            <td style="font-size:large;padding:0px!important;text-align:center">
                                                <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                    <i class="mdi mdi-delete"></i>
                                                </a>
                                            </td>
                                        }
                                    }
                                </tr>
                            }

                        </tbody>
                    </table>

                </div>
            </div>

        }
        else if (filtre == "unique")
        {
            <div class="card">
                <div class="card-body">

                    <div class="table-responsive">
                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                            <thead>
                                <tr>
                                    <th>Actions</th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                    </th>
                                    <th>
                                        @Html.DisplayName("Client")
                                    </th>

                                    <th>
                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                    </th>

                                    <th>
                                        @Html.DisplayNameFor(model => model.Montant)
                                    </th>
                                    <th>
                                        @Html.DisplayName("Devise")
                                    </th>

                                    @{
                                        if (ViewData["comp"].ToString() == "apurement")
                                        {

                                            <th>
                                                Délai
                                            </th>
                                            <th>
                                                Documents manquants
                                            </th>

                                        }
                                    }

                                    <th>
                                        @Html.DisplayName("Statut")
                                    </th>
                                    <th class="partage">Responsable</th>
                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                </tr>

                            </thead>


                            <tbody>
                                @{ int i = 0;}
                                @foreach (var item in Model)
                                {
                                    i++;
                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                        <td class="att">
                                            <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3).ToString()" doss-id="@item.Dossier_Id"></i>
                                        </td>
                                        <td>
                                            @{
                                                if (item.ReferenceExterne != null)
                                                {
                                                    try
                                                    {
                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                    }
                                                    catch (Exception)
                                                    { }
                                                }
                                                else
                                                {
                                                    <label>Non attribuée</label>
                                                }
                                            }
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                        </td>
                                        <td>
                                            @{
                                                if (item.Fournisseur != null)
                                                {
                                                    <label>
                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                    </label>
                                                }
                                            }
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.MontantString)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                        </td>

                                        @*@Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)*@

                                        @{
                                            if (ViewData["comp"].ToString() == "apurement")
                                            {

                                                <td>
                                                    @item.GetDelai jours
                                                </td>
                                                <td>
                                                    @{
                                                        try
                                                        {
                                                            @(!string.IsNullOrEmpty(item.InfoPercentage)?item.InfoPercentage.Replace("Documents manquants: ",""):"")
                                                        }
                                                        catch
                                                        { }


                                                    }
                                                </td>
                                                <td class="att">
                                                    @{
                                                        @*StatutDossier statut = item.GetStatusString();
                                                            <a id="link-@item.Dossier_Id" class="card-item1" href="@Url.Content("~/Dossiers_banque/Details/"+item.Dossier_Id)" title="@Html.Raw(statut.Motif)">
                                                                <span class="progress-bar" style="width: auto;background-color:@item.GetCouleurApurement;color:white">@statut.Statut1</span>
                                                            </a>*@
                                                    }
                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                </td>
                                            }
                                            else
                                            {
                                                <td class="att">
                                                    @*@{
                                                            StatutDossier statut = item.GetStatusString();
                                                            <a id="link-@item.Dossier_Id" class="card-item1" href="@Url.Content("~/Dossiers_banque/Details/"+item.Dossier_Id)" title="@Html.Raw(statut.Motif)">
                                                                <span class="progress-bar" style="width: auto;background-color:@statut.Couleur;">@statut.Statut1</span>
                                                            </a>
                                                        }*@
                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                </td>
                                            }
                                        }
                                        <td class="att">
                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                        </td>
                                        @{
                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                            {
                                                action = true;
                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                        <i class="mdi mdi-delete"></i>
                                                    </a>
                                                </td>
                                            }
                                        }
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>
                    @{
                        if (action)
                        {
                            <style>
                                #tb-action {
                                    display: initial;
                                }
                            </style>

                        }
                    }
                </div>
            </div>
        }
        else if (ViewBag.accueil == "all-dfx")
        {
            //dossiers dfx
            @Html.Partial("~/Views/_Shared/PartialViews/Dfx.cshtml", new List<int>() { })
        }
        else if (ViewBag.accueil == "all-ref")
        {
            //refinancement

            @Html.Partial("~/Views/_Shared/PartialViews/Refinancement.cshtml", new List<int>() { })
        }
        else
        {
            <div class="card">
                <div class="card-body">

                    <div class="table-responsive">
                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                            <thead>
                                <tr>
                                    <th>ACtions</th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                    </th>
                                    <th>
                                        @Html.DisplayName("Client")
                                    </th>

                                    <th>
                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                    </th>

                                    <th>
                                        @Html.DisplayNameFor(model => model.Montant)
                                    </th>
                                    <th>
                                        @Html.DisplayName("Devise")
                                    </th>

                                    <th>
                                        @Html.DisplayName("Statut")
                                    </th>
                                    <th class="partage">Responsable</th>
                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                </tr>

                            </thead>


                            <tbody>
                                @{ int i = 0;}
                                @foreach (var item in Model)
                                {
                                    i++;
                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                        <td class="att">
                                            <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                        </td>
                                        <td>
                                            @{
                                                if (item.ReferenceExterne != null)
                                                {
                                                    try
                                                    {
                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                    }
                                                    catch (Exception)
                                                    { }
                                                }
                                                else
                                                {
                                                    <label>Non attribuée</label>
                                                }
                                            }
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                        </td>
                                        <td>
                                            @{
                                                if (item.Fournisseur != null)
                                                {
                                                    <label>
                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                    </label>
                                                }
                                            }
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.MontantString)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                        </td>

                                        <td>
                                            @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                        </td>
                                        <td class="att">
                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                        </td>
                                        @{
                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                            {
                                                action = true;
                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                        <i class="mdi mdi-delete"></i>
                                                    </a>
                                                </td>
                                            }
                                        }
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>
                    @{
                        if (action)
                        {
                            <style>
                                #tb-action {
                                    display: initial;
                                }
                            </style>

                        }
                    }
                </div>
            </div>
        }
    }
    else if (minSite == 1 || minSite == 4)
    {
        if (numComp > 2)
        {
            <div class="row">
                <div class="">
                    <h4 class="text-info" style="padding-left:25px;display:inline-block">
                        <i class="mdi mdi-tag-multiple"></i>
                        Conformité
                    </h4>
                </div>
                <div class="col-12">
                    <div class="card-header bg-gradient-primary text-white">Dossiers à la conformité</div>
                    <div class="card">
                        <div class="card-body">

                            <div class="table-responsive">
                                <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                    <thead>
                                        <tr>
                                            <th>
                                                Actions
                                            </th>
                                            <th>
                                                @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                            </th>
                                            <th>
                                                @Html.DisplayName("Client")
                                            </th>

                                            <th>
                                                @Html.DisplayNameFor(model => model.Fournisseur)
                                            </th>

                                            <th>
                                                @Html.DisplayNameFor(model => model.Montant)
                                            </th>
                                            <th>
                                                @Html.DisplayName("Devise")
                                            </th>

                                            <th>
                                                @Html.DisplayName("Statut")
                                            </th>
                                            <th class="partage">Responsable</th>
                                            <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                        </tr>

                                    </thead>


                                    <tbody>
                                        @{ int i = 0;}
                                        @foreach (var item in Model.Where(d => d.EtapesDosier < 5))
                                        {
                                            i++;
                                            <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                <td class="att">
                                                    <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                </td>
                                                <td>
                                                    @{
                                                        if (item.ReferenceExterne != null)
                                                        {
                                                            try
                                                            {
                                                                <label>@item.ReferenceExterne.NumeroRef</label>
                                                            }
                                                            catch (Exception)
                                                            { }
                                                        }
                                                        else
                                                        {
                                                            <label>Non attribuée</label>
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Client.Nom)
                                                </td>
                                                <td>
                                                    @{
                                                        if (item.Fournisseur != null)
                                                        {
                                                            <label>
                                                                @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                            </label>
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.MontantString)
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                </td>

                                                <td>
                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                </td>
                                                <td class="att">
                                                    @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                </td>
                                                @{
                                                    if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                    {
                                                        action = true;
                                                        <td style="font-size:large;padding:0px!important;text-align:center">
                                                            <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                <i class="mdi mdi-delete"></i>
                                                            </a>
                                                        </td>
                                                    }
                                                }
                                            </tr>
                                        }

                                    </tbody>
                                </table>
                            </div>
                            @{
                                if (action)
                                {
                                    <style>
                                        #tb-action {
                                            display: initial;
                                        }
                                    </style>

                                }
                            }
                        </div>
                    </div>
                </div> <!-- end col -->
                <hr />
                <div class="">
                    <h4 class="text-info" style="padding-left:25px;display:inline-block">
                        <i class="mdi mdi-tag-multiple"></i>
                        Service transfert
                    </h4>
                    <div style="display:inline-block;float:right;margin-right:15px">
                        <div class="form-check mb-3" style="display:inline-block">
                            <input class="form-check-input" type="radio" name="formRadios"
                                   id="formRadios1" checked>
                            <label class="form-check-label" for="formRadios1">
                                DFX
                            </label>
                        </div>
                        <div class="form-check" style="display:inline-block">
                            <input class="form-check-input" type="radio" name="formRadios"
                                   id="formRadios2">
                            <label class="form-check-label" for="formRadios2">
                                Refinancement
                            </label>
                        </div>
                    </div>
                </div>
                <div class="col-12">
                    <div class="card-header bg-gradient-primary text-white">
                        Dossiers au service transfert
                    </div>
                    <div class="card">
                        <div class="card-body">

                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th>
                                            @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                        </th>
                                        <th>
                                            @Html.DisplayName("Client")
                                        </th>

                                        <th>
                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                        </th>

                                        <th>
                                            @Html.DisplayNameFor(model => model.Montant)
                                        </th>
                                        <th>
                                            @Html.DisplayName("Devise")
                                        </th>

                                        <th>
                                            @Html.DisplayName("Statut")
                                        </th>
                                        <th class="partage">Responsable</th>
                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                    </tr>

                                </thead>


                                <tbody>
                                    @{ i = 0;}
                                    @foreach (var item in Model.Where(d => d.EtapesDosier >= 5))
                                    {
                                        i++;
                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                            <td>
                                                @{
                                                    if (item.ReferenceExterne != null)
                                                    {
                                                        try
                                                        {
                                                            <label>@item.ReferenceExterne.NumeroRef</label>
                                                        }
                                                        catch (Exception)
                                                        { }
                                                    }
                                                    else
                                                    {
                                                        <label>Non attribuée</label>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                            </td>
                                            <td>
                                                @{
                                                    if (item.Fournisseur != null)
                                                    {
                                                        <label>
                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                        </label>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.MontantString)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                            </td>


                                            <td>
                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                            </td>
                                            <td class="att">
                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                            </td>
                                            @{
                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                {
                                                    action = true;
                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                            <i class="mdi mdi-delete"></i>
                                                        </a>
                                                    </td>
                                                }
                                            }
                                        </tr>
                                    }

                                </tbody>
                            </table>

                            @{
                                if (action)
                                {
                                    <style>
                                        #tb-action {
                                            display: initial;
                                        }
                                    </style>

                                }
                            }
                        </div>
                    </div>
                </div> <!-- end col -->
            </div>
        }
        else
        {
            <div class="row">
                <div class="col-12">
                    <div class="card-header bg-gradient-primary text-white">En cours de traitement</div>
                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                    <thead>
                                        <tr>
                                            <th>
                                                Actions
                                            </th>
                                            <th>
                                                @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                            </th>
                                            <th>
                                                @Html.DisplayName("Client")
                                            </th>

                                            <th>
                                                @Html.DisplayNameFor(model => model.Fournisseur)
                                            </th>

                                            <th>
                                                @Html.DisplayNameFor(model => model.Montant)
                                            </th>
                                            <th>
                                                @Html.DisplayName("Devise")
                                            </th>
                                            <th>
                                                @Html.DisplayName("Statut")
                                            </th>
                                            <th class="partage">Responsable</th>
                                            <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                        </tr>

                                    </thead>


                                    <tbody>
                                        @{ int i = 0;}
                                        @foreach (var item in Model)//.Where(d => d.EtapesDosier <= 5))
                                        {
                                            i++;
                                            <tr data*-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">
                                                <td class="att">
                                                    <i class="fa fas fa-ellipsis-v fs-5 icon-action" estBeac="@(item.DFX6FP6BEAC==3)" doss-id="@item.Dossier_Id"></i>
                                                </td>
                                                <td>
                                                    @{
                                                        if (item.ReferenceExterne != null)
                                                        {
                                                            try
                                                            {
                                                                <label>@item.ReferenceExterne.NumeroRef</label>
                                                            }
                                                            catch (Exception)
                                                            { }
                                                        }
                                                        else
                                                        {
                                                            <label>Non attribuée</label>
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Client.Nom)
                                                </td>
                                                <td>
                                                    @{
                                                        if (item.Fournisseur != null)
                                                        {
                                                            <label>
                                                                @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                            </label>
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.MontantString)
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                </td>

                                                <td>
                                                    @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                </td>
                                                <td class="att">
                                                    @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                </td>
                                                @{
                                                    if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                    {
                                                        action = true;
                                                        <td style="font-size:large;padding:0px!important;text-align:center">
                                                            <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                <i class="mdi mdi-delete"></i>
                                                            </a>
                                                        </td>
                                                    }
                                                }
                                            </tr>
                                        }

                                    </tbody>
                                </table>
                            </div>
                            @{
                                if (action)
                                {
                                    <style>
                                        #tb-action {
                                            display: initial;
                                        }
                                    </style>

                                }
                            }
                        </div>
                    </div>
                </div> <!-- end col -->
            </div>

        }
    }
    else if (minSite == 6)
    {
        <div class="row">
            <div class="col-12">
                <div class="card-header bg-gradient-primary text-white">En rapport avec la conformité</div>
                <div class="card">
                    <div class="card-body">

                        <div class="table-responsive">
                            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th>
                                            @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                        </th>
                                        <th>
                                            @Html.DisplayName("Client")
                                        </th>

                                        <th>
                                            @Html.DisplayNameFor(model => model.Fournisseur)
                                        </th>

                                        <th>
                                            @Html.DisplayNameFor(model => model.Montant)
                                        </th>
                                        <th>
                                            @Html.DisplayName("Devise")
                                        </th>
                                        <th>
                                            @Html.DisplayName("Statut")
                                        </th>
                                        <th class="partage" tyle="padding-top:10px">Responsable</th>
                                        <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                    </tr>

                                </thead>


                                <tbody>
                                    @{ int i = 0;}
                                    @foreach (var item in Model)//.Where(d => d.EtapesDosier < 5))
                                    {
                                        i++;
                                        <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                            <td>
                                                @{
                                                    if (item.ReferenceExterne != null)
                                                    {
                                                        try
                                                        {
                                                            <label>@item.ReferenceExterne.NumeroRef</label>
                                                        }
                                                        catch (Exception)
                                                        { }
                                                    }
                                                    else
                                                    {
                                                        <label>Non attribuée</label>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Client.Nom)
                                            </td>
                                            <td>
                                                @{
                                                    if (item.Fournisseur != null)
                                                    {
                                                        <label>
                                                            @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                        </label>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.MontantString)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                            </td>

                                            <td>
                                                @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                            </td>
                                            <td class="att">
                                                @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                            </td>
                                            @{
                                                if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                {
                                                    action = true;
                                                    <td style="font-size:large;padding:0px!important;text-align:center">
                                                        <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                            <i class="mdi mdi-delete"></i>
                                                        </a>
                                                    </td>
                                                }
                                            }
                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>
                        @{
                            if (action)
                            {
                                <style>
                                    #tb-action {
                                        display: initial;
                                    }
                                </style>

                            }
                        }
                    </div>
                </div>
            </div> <!-- end col -->
        </div>
    }
    else
    {
        if (numComp < 7)
        {
            <div class="row">
                <div class="card1">
                    <div class="card-body1">
                        <ul class="nav nav-pills nav-justified bg-default" role="tablist" style="margin-left:15px;margin-right:15px;margin-bottom:-12px">
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link active" data-bs-toggle="tab" href="#navpills2-home"
                                   role="tab">
                                    <i class="mdi mdi-tag-multiple"></i>&emsp; DFX
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#navpills2-profile" role="tab">
                                    <i class="mdi mdi-tag-multiple"></i>&emsp; Refinancement
                                </a>
                            </li>
                        </ul>

                        <div class="tab-content p-3 text-muted">
                            <div class="tab-pane active" id="navpills2-home" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Client")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Montant)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Devise")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayName("Statut")
                                                    </th>
                                                    <th class="partage">Responsable</th>
                                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                </tr>

                                            </thead>


                                            <tbody>
                                                @{ int i = 0;}
                                                @foreach (var item in Model.Where(d => d.Montant <= 50000000))
                                                {
                                                    i++;
                                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                        <td>
                                                            @{
                                                                if (item.ReferenceExterne != null)
                                                                {
                                                                    try
                                                                    {
                                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                                    }
                                                                    catch (Exception)
                                                                    { }
                                                                }
                                                                else
                                                                {
                                                                    <label>Non attribuée</label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                                        </td>
                                                        <td>
                                                            @{
                                                                if (item.Fournisseur != null)
                                                                {
                                                                    <label>
                                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                    </label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.Montant)
                                                        </td>
                                                        <td>
                                                            @*@Html.DisplayFor(modelItem => item.EtapesDosier) |
                                                                @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)*@
                                                        </td>

                                                        <td>
                                                            @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                        </td>
                                                        <td class="att">
                                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                        </td>
                                                        @{
                                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                            {
                                                                action = true;
                                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                        <i class="mdi mdi-delete"></i>
                                                                    </a>
                                                                </td>
                                                            }
                                                        }
                                                    </tr>
                                                }

                                            </tbody>
                                        </table>

                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }
                                        }
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane" id="navpills2-profile" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Client")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Montant)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Devise")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayName("Statut")
                                                    </th>
                                                    <th class="partage">Responsable</th>
                                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                </tr>

                                            </thead>


                                            <tbody>
                                                @{ i = 0;}
                                                @foreach (var item in Model.Where(d => d.Montant > 50000000))
                                                {
                                                    i++;
                                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                        <td>
                                                            @{
                                                                if (item.ReferenceExterne != null)
                                                                {
                                                                    try
                                                                    {
                                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                                    }
                                                                    catch (Exception)
                                                                    { }
                                                                }
                                                                else
                                                                {
                                                                    <label>Non attribuée</label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                                        </td>
                                                        <td>
                                                            @{
                                                                if (item.Fournisseur != null)
                                                                {
                                                                    <label>
                                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                    </label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.MontantString)
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                        </td>

                                                        <td>
                                                            @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                        </td>
                                                        <td class="att">
                                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                        </td>
                                                        @{
                                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                            {
                                                                action = true;
                                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                        <i class="mdi mdi-delete"></i>
                                                                    </a>
                                                                </td>
                                                            }
                                                        }
                                                    </tr>
                                                }

                                            </tbody>
                                        </table>

                                        @{
                                            if (action)
                                            {
                                                <style>
                                                    #tb-action {
                                                        display: initial;
                                                    }
                                                </style>

                                            }


                                        }
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        }
        else
        {
            <div class="row">
                <div class="card1">
                    <div class="card-body1">
                        <ul class="nav nav-pills nav-justified bg-default" role="tablist" style="margin-left:15px;margin-right:15px;margin-bottom:-12px">
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link active" data-bs-toggle="tab" href="#encours-1" role="tab">
                                    <i class="mdi mdi-tag-multiple"></i>&emsp; En cours
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#traités" role="tab">
                                    <i class="mdi mdi-tag-multiple"></i>&emsp; Accordés
                                </a>
                            </li>
                            <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-bs-toggle="tab" href="#rejetes" role="tab">
                                    <i class="mdi mdi-tag-multiple"></i>&emsp; Rejetés
                                </a>
                            </li>
                        </ul>
                        <div class="tab-content p-3 text-muted">
                            <div class="tab-pane active" id="encours-1" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Client")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Montant)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Devise")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayName("Statut")
                                                    </th>
                                                    <th class="partage">Responsable</th>
                                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @{ int i = 0;}
                                                @foreach (var item in Model.Where(d => d.EtapesDosier < 10))//.Where(d => d.EtapesDosier < 5))
                                                {
                                                    i++;
                                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                        <td>
                                                            @{
                                                                if (item.ReferenceExterne != null)
                                                                {
                                                                    try
                                                                    {
                                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                                    }
                                                                    catch (Exception)
                                                                    { }
                                                                }
                                                                else
                                                                {
                                                                    <label>Non attribuée</label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                                        </td>
                                                        <td>
                                                            @{
                                                                if (item.Fournisseur != null)
                                                                {
                                                                    <label>
                                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                    </label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.MontantString)
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                        </td>

                                                        <td>
                                                            @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                        </td>
                                                        <td class="att">
                                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                        </td>
                                                        @{
                                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                            {
                                                                action = true;
                                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                        <i class="mdi mdi-delete"></i>
                                                                    </a>
                                                                </td>
                                                            }
                                                        }
                                                    </tr>
                                                }

                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="traités" role="tabpanel" style="">
                                <div class="card">
                                    <div class="card-body">

                                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Client")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Montant)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Devise")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayName("Statut")
                                                    </th>
                                                    <th class="partage">Responsable</th>
                                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                </tr>

                                            </thead>


                                            <tbody>
                                                @{ i = 0;}
                                                @foreach (var item in Model.Where(d => d.EtapesDosier == 10))//.Where(d => d.EtapesDosier < 5))
                                                {
                                                    i++;
                                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                        <td>
                                                            @{
                                                                if (item.ReferenceExterne != null)
                                                                {
                                                                    try
                                                                    {
                                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                                    }
                                                                    catch (Exception)
                                                                    { }
                                                                }
                                                                else
                                                                {
                                                                    <label>Non attribuée</label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                                        </td>
                                                        <td>
                                                            @{
                                                                if (item.Fournisseur != null)
                                                                {
                                                                    <label>
                                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                    </label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.MontantString)
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                        </td>

                                                        <td>
                                                            @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                        </td>
                                                        <td class="att">
                                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                        </td>
                                                        @{
                                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                            {
                                                                action = true;
                                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                        <i class="mdi mdi-delete"></i>
                                                                    </a>
                                                                </td>
                                                            }
                                                        }
                                                    </tr>
                                                }

                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="rejetes" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">

                                        <table id="datatable-buttons1" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        @Html.DisplayNameFor(model => model.ReferenceExterne.NumeroRef)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Client")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Fournisseur)
                                                    </th>

                                                    <th>
                                                        @Html.DisplayNameFor(model => model.Montant)
                                                    </th>
                                                    <th>
                                                        @Html.DisplayName("Devise")
                                                    </th>

                                                    <th>
                                                        @Html.DisplayName("Statut")
                                                    </th>
                                                    <th class="partage" style="padding-top:10px">Att</th>
                                                    <th id="tb-action" style="display:none;padding-top:10px">Action</th>
                                                </tr>

                                            </thead>


                                            <tbody>
                                                @{ i = 0;}
                                                @foreach (var item in Model.Where(d => d.EtapesDosier == -4))//.Where(d => d.EtapesDosier < 5))
                                                {
                                                    i++;
                                                    <tr data-id="@item.Dossier_Id" style="cursor:pointer" idd="link-@item.Dossier_Id" class="ligne">

                                                        <td>
                                                            @{
                                                                if (item.ReferenceExterne != null)
                                                                {
                                                                    try
                                                                    {
                                                                        <label>@item.ReferenceExterne.NumeroRef</label>
                                                                    }
                                                                    catch (Exception)
                                                                    { }
                                                                }
                                                                else
                                                                {
                                                                    <label>Non attribuée</label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.Client.Nom)
                                                        </td>
                                                        <td>
                                                            @{
                                                                if (item.Fournisseur != null)
                                                                {
                                                                    <label>
                                                                        @Html.DisplayFor(modelItem => item.Fournisseur.Nom)
                                                                    </label>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.MontantString)
                                                        </td>
                                                        <td>
                                                            @Html.DisplayFor(modelItem => item.DeviseMonetaire.Nom)
                                                        </td>

                                                        <td>
                                                            @Html.Partial("~/Views/_Shared/PartialViews/StatusDossiers.cshtml", item)
                                                        </td>
                                                        <td class="att">
                                                            @Html.Partial("~/Views/_Shared/PartialViews/Attribute.cshtml", item)
                                                        </td>
                                                        @{
                                                            if (item.EtapesDosier == 0 || item.EtapesDosier == null || Session["Profile"] == "admin")
                                                            {
                                                                action = true;
                                                                <td style="font-size:large;padding:0px!important;text-align:center">
                                                                    <a title="Supprimer" class="text-danger" _action_requied_loader="0" href="@Url.Content("~/Dossiers_banque/Delete/"+item.Dossier_Id)">
                                                                        <i class="mdi mdi-delete"></i>
                                                                    </a>
                                                                </td>
                                                            }
                                                        }
                                                    </tr>
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        }
        <!-- end row -->
    }
}

<a href="#" id="show-modal-actions" class="hidden" data-bs-toggle="modal" data-bs-target="#modal-actions-dossier"></a>
@Html.Partial("~/Views/Dossiers_banque/Modal_Actions.cshtml")

<!-- JAVASCRIPT -->
<!--<script src="~/assets/libs/jquery/jquery.min.js"></script>
<script src="~/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="~/assets/libs/metismenu/metisMenu.min.js"></script>
<script src="~/assets/libs/simplebar/simplebar.min.js"></script>
<script src="~/assets/libs/node-waves/waves.min.js"></script>
<script src="~/assets/libs/waypoints/lib/jquery.waypoints.min.js"></script>
<script src="~/assets/libs/jquery.counterup/jquery.counterup.min.js"></script>-->
<!-- Required datatable js -->
<!--<script src="~/assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="~/assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>-->
<!-- Buttons examples -->
<!--<script src="~/assets/libs/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
<script src="~/assets/libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
<script src="~/assets/libs/jszip/jszip.min.js"></script>
<script src="~/assets/libs/pdfmake/build/pdfmake.min.js"></script>
<script src="~/assets/libs/pdfmake/build/vfs_fonts.js"></script>
<script src="~/assets/libs/datatables.net-buttons/js/buttons.html5.min.js"></script>
<script src="~/assets/libs/datatables.net-buttons/js/buttons.print.min.js"></script>
<script src="~/assets/libs/datatables.net-buttons/js/buttons.colVis.min.js"></script>-->
<!-- Responsive examples -->
<!--<script src="~/assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="~/assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>-->
<!-- Datatable init js -->
<!--<script src="~/assets/js/pages/datatables.init.js"></script>

<script src="~/assets/js/app.js"></script>-->

@Html.Partial("~/Views/_Shared/_Script_DataList.cshtml")

<div class="all-users1 border border-1 border-info card p-1 p-0" id="call-users" style="position:absolute;z-index:500;max-width:350px;display:none">
    <div class="bg-info m-0 pr-1 text-white" id="ffermeCallusers" style="cursor:pointer;margin-right:5px" title="Fermer">Responsables du dossier <span class="text-white fs-5 float-end">X</span></div>
    <!-- item-->
    <div class="card-body1" style="width: 350px;margin-left:0px;padding-bottom:20px; overflow-x: scroll">
        <a href="javascript:void(0);" class="dropdown-item notify-item" title="responsable agence">
            <i class="fa fa-user-alt fs-6 text-info"></i> Agence: <span class="align-middle" style="font-weight:bold" id="agence-resp"> </span>
        </a>
        <a href="javascript:void(0);" id="back-office-resp-parent" style="display:none" class="dropdown-item notify-item" title="responsable back-office">
            <i class="fa fa-user-alt fs-6 text-info"></i> Back-office: <span class="align-middle" style="font-weight:bold" id="back-office-resp"> </span>
        </a>
        <a href="javascript:void(0);" id="conform-resp-parent" style="display:none" class="dropdown-item notify-item" title="Responsable conformité">
            <i class="fa fa-user-alt fs-6 text-warning"></i> Conformité: <span class="align-middle" style="font-weight:bold" id="conform-resp"> </span>
        </a>
        <a href="javascript:void(0);" id="trans-resp-parent" style="display:none" class="dropdown-item notify-item" title="Responsable service transfert">
            <i class="fa fa-user-alt fs-6 text-purple"></i> Transfert: <span class="align-middle" style="font-weight:bold" id="trans-resp"> </span>
        </a>
    </div>
</div>

@{
    //if (Session["estChef"].ToString() != "True")
    {
        <script>
            //$(".partage").hide();
            //$(".att").hide();
        </script>
    }
}
<script>
    $(document).ready(function () {
        //Actions
        try {
            var ctent = "";
            $('.icon-action').click(function () {
                ctent = "Deplacer le dossier vers les dossiers";
                ctent += this.getAttribute('estBeac') == "False" ? " BEAC" : " internes";
                //$('#action-name0').text(ctent);
                //$('#btn-change-wf').val(this.getAttribute('doss-id'));
                var iframAction = document.getElementById('iframe-model-action');
                iframAction.onload = function () {
                };
                iframAction.setAttribute('src', '@Url.Content("~/dossiers_banque/ActionsVew?id=")' + this.getAttribute('doss-id'));
                document.getElementById('show-modal-actions').click();
            });

            $('#btn-change-wf').on('input', function () {
                if (this.checked) {
                    if (confirm('Voullez-vous ' + ctent.toLowerCase()+"?")) {
                        $.ajax({
                            url: '@Url.Content("~/dossiers_banque/changewf?doss=")' +this.value,
                            success: function (responce) {
                                document.location.reload();
                            },
                            error: function (responce) { alert("Echec de deplacement du dossier") }
                        });
                    }
                }
            });
        } catch (e) {

        }
        //attribuer doss
        //action apres bouton selction
        $('.att-link').click(function () {
            var _this = this;
            var selid = 'att-sel-' + this.getAttribute("idd");
            var lab = document.getElementById('att-lab-' + this.getAttribute("idd"));
            $(lab).hide();
            $(this).hide();
            $('#att-close-' + this.getAttribute("idd")).show();
            $('#att-icon-' + this.getAttribute("idd")).show();
            $('#' + selid).show();
            $.ajax({
                url: '@Url.Content("~/comptebanquecommerciales/getAgents")',
                success: function (responce) {
                    var daySelect = document.getElementById('' + selid);
                    var length = daySelect.options.length;
                    for (i = length - 1; i >= 0; i--) {
                        daySelect.options[i] = null;
                    }
                    daySelect.options[daySelect.options.length] = new Option($(lab).text(), '');
                    $.each(responce, function (index, item) {
                        daySelect.options[daySelect.options.length] = new Option('' + item.Nom, item.Id);
                    });
                    $('#att-icon-' + _this.getAttribute("idd")).hide();
                },
                error: function (responce) { alert(responce.error) }
            });
        });
        //action apres bouton close
        $('.att-close').click(function () {
            $(this).hide();
            $('#att-lab-' + this.getAttribute("idd")).show();
            $('#att-link-' + this.getAttribute("idd")).show();
            $('#att-sel-' + this.getAttribute("idd")).hide();
        });

        //action apres selection d'un agent
        $('.att-sel').on("change", function () {
            var sel = this;
            var laid = 'att-lab-' + this.getAttribute("idd");
            $('#att-icon-' + this.getAttribute("idd")).show();
            $.ajax({
                url: '@Url.Content("~/comptebanquecommerciales/attribute?doss=")' + this.getAttribute("idd")+"&agent="+this.value,
                success: function (responce) {
                    $(sel).hide();
                    $('#' + laid).text(responce);
                    $('#' + laid).show();
                    $('#att-icon-' + sel.getAttribute("idd")).hide();
                    var daySelect = document.getElementById('' + selid);
                    var length = daySelect.options.length;
                    for (i = length - 1; i >= 0; i--) {
                        daySelect.options[i] = null;
                    }
                },
                error: function (responce) { alert("Echec d'attribution du dossier") }
            });
        });

        $('.ligne td').click(function () {
            if (!this.classList.contains("att")) {
                document.getElementById('' + this.parentElement.getAttribute('idd')).click();
                $("#Preloader_partiel").show();
            } else {
            }
        });

        //get all users
        try {
            $('.all-users0').click(function () {
                var btn = this;
                var moi = this.childNodes[1];
                moi.classList.remove('fa-users');
                moi.classList.remove('fa');
                moi.classList.add('mdi');
                moi.classList.add('mdi-spin');
                moi.classList.add('mdi-loading');
                var calusers = document.getElementById('call-users');
                $(calusers).hide();

                document.getElementById('agence-resp').textContent = "";
                document.getElementById('agence-resp').setAttribute('title', "");
                document.getElementById('conform-resp').textContent = "";
                document.getElementById('conform-resp').setAttribute('title', "");
                document.getElementById('trans-resp').textContent = "";
                document.getElementById('trans-resp').setAttribute('title', "");
                document.getElementById('back-office-resp').textContent = "";
                document.getElementById('back-office-resp').setAttribute('title', "");

                $.ajax({
                    url: '@Url.Content("~/dossiers_banque/getrespons?iddoss=")' + this.value,
                    success: function (res) {
                        try {
                            var dd = res[0].split('_');
                            document.getElementById('agence-resp').textContent = dd[0];
                            document.getElementById('agence-resp').setAttribute('title',"(Tel: " + dd[1] + ". Email: " + dd[2] + ")");
                        } catch (e) {

                        }
                        try {
                            var dd = res[1].split('_');
                            document.getElementById('conform-resp-parent').style.display = 'initial';
                            document.getElementById('conform-resp').textContent = dd[0];
                            document.getElementById('conform-resp').setAttribute('title', "(Tel: " + dd[1] + ". Email: " + dd[2] + ")");

                        } catch (e) {

                        }
                        try {
                            var dd = res[2].split('_');
                            document.getElementById('trans-resp-parent').style.display = 'initial';
                            document.getElementById('trans-resp').textContent = dd[0];
                            document.getElementById('trans-resp').setAttribute('title', "(Tel: " + dd[1] + ". Email: " + dd[2] + ")");
                        } catch (e) {

                        }
                        try {
                            var dd = res[3].split('_');
                            document.getElementById('back-office-resp-parent').style.display='initial';
                            document.getElementById('back-office-resp').textContent = dd[0];
                            document.getElementById('back-office-resp').setAttribute('title', "(Tel: " + dd[1] + ". Email: " + dd[2] + ")");
                        } catch (e) {

                        }
                        calusers.style.top = Number(btn.offsetTop + calusers.offsetHeight + 80) + "px";
                        calusers.style.left = Number(btn.offsetLeft-220) + 'px';
                        moi.classList.remove('mdi');
                        moi.classList.remove('mdi-spin');
                        moi.classList.remove('mdi-loading');
                        moi.classList.add('fa');
                        moi.classList.add('fa-users');
                        calusers.style.display = 'initial';
                },
                    error: function (responce) { alert(responce.error) }
                });
            });
        } catch (e) {
        }
        $("#ffermeCallusers").click(function () {
            $('#call-users').hide(300);
        });

        $('thead').addClass("bg-gradient-primary text-white");
        $('.nav-pills').addClass("bg-white");
    });
</script>
<script type="text/javascript">
    $('#modal-actions-dossier').on('hidden.bs.modal', function (e) {
        var etat = document.getElementById('iframe-model-action').getAttribute('etat');
        if (etat == "1") {
            window.location.reload();
        }
    })
</script>